<div class="container">
  <div *ngIf="espaciosAcademicosSeleccionados.length == 0" class="alert info">
    <mat-icon class="icon">info</mat-icon>
    <span>{{
      "gestion_horarios.mensaje_copiar_horario_lista" | translate
    }}</span>
  </div>
  <h3 class="mt-4 mb-3">
    {{ "gestion_horarios.horario_espacio_academico" | translate }}
  </h3>
  <div>
    <table mat-table [dataSource]="espaciosAcademicos" matSort>
      <ng-container
        *ngFor="let columna of espaciosAcademicosContructorTabla"
        [matColumnDef]="columna.columnDef"
      >
        <th mat-header-cell *matHeaderCellDef>
          <ng-container
            *ngIf="columna.columnDef === 'acciones'; else headerTemplate"
          >
            <mat-checkbox
              (change)="toggleAllCheckboxes($event)"
              [checked]="isAllSelected()"
              [indeterminate]="isSomeSelected() && !isAllSelected()"
            >
            </mat-checkbox>
          </ng-container>
          <ng-template #headerTemplate>
            <ng-container *ngIf="columna.sortable; else noSort">
              <div mat-sort-header>
                <b>{{ columna.header | translate }}</b>
              </div>
            </ng-container>
            <ng-template #noSort>
              <div>
                <b>{{ columna.header | translate }}</b>
              </div>
            </ng-template>
          </ng-template>
        </th>

        <td mat-cell *matCellDef="let row">
          <ng-container
            *ngTemplateOutlet="
              cellTemplate;
              context: { $implicit: columna, row: row }
            "
          ></ng-container>
        </td>
        <ng-template #cellTemplate let-columna let-row="row">
          <ng-container [ngSwitch]="columna.columnDef">
            <div *ngSwitchCase="'acciones'">
              <mat-checkbox
                [(ngModel)]="row.isSelected"
                (change)="checkboxEspacioAcademico(row)"
              >
              </mat-checkbox>
            </div>
            <span *ngSwitchDefault>{{ columna.cell(row) }}</span>
          </ng-container>
        </ng-template>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="tablaColumnas"></tr>
      <tr mat-row *matRowDef="let row; columns: tablaColumnas"></tr>
    </table>
    <mat-paginator
      #paginator
      class="mt-3"
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
  <div class="row mt-4" *ngIf="espaciosAcademicosSeleccionados.length > 0">
    <div class="col-12">
      <div class="alert info">
        <mat-icon class="icon">info</mat-icon>
        <span>{{
          "gestion_horarios.mensaje_copiar_horario_formulario" | translate
        }}</span>
      </div>
    </div>
    <div class="col-12 mt-3">
      <form [formGroup]="formCopiadoHorario">
        <div class="row">
          <ng-container *ngFor="let field of selectsCopiadoHorario">
            <mat-form-field class="col-4 medium" appearance="outline">
              <mat-label>{{ field.label | translate }}</mat-label>
              <mat-icon class="mat-icon-outlined" color="primary" matPrefix>{{
                field.icon
              }}</mat-icon>
              <mat-select
                [formControlName]="field.name"
                (selectionChange)="
                  field.onChange && this[field.onChange]($event.value)
                "
              >
                <mat-option disabled value=""
                  >--{{ "GLOBAL.seleccionar" | translate }}--</mat-option
                >
                <mat-option
                  *ngFor="let item of this[field.options]"
                  [value]="item"
                  >{{ item.Nombre }}</mat-option
                >
              </mat-select>
            </mat-form-field>
          </ng-container>
        </div>
        <div class="center-h">
          <button
            (click)="copiarHorario()"
            mat-flat-button
            color="primary"
            [disabled]="!formCopiadoHorario.valid"
          >
            {{ "gestion_horarios.copiar_horario" | translate }}
          </button>
        </div>
      </form>
    </div>
  </div>
  <div></div>
</div>
